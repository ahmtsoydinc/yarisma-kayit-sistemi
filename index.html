<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YarÄ±ÅŸma Hayvan KayÄ±t Sistemi v11 (Modern Blur)</title>
  <style>
    :root{
      --bg-grad-1:#0f172a; /* slate-900 */
      --bg-grad-2:#1e293b; /* slate-800 */
      --card-bg:rgba(255,255,255,.06);
      --card-border:rgba(255,255,255,.12);
      --glass-shadow:0 10px 30px rgba(2,6,23,.45);
      --text:#e5e7eb; /* slate-200 */
      --muted:#94a3b8; /* slate-400 */
      --brand:#22c55e; /* green-500 */
      --brand-strong:#16a34a; /* green-600 */
      --danger:#ef4444; /* red-500 */
      --warn:#f59e0b; /* amber-500 */
      --line:#334155; /* slate-600 */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family:"Segoe UI",system-ui,-apple-system,Roboto,Arial,Helvetica,sans-serif;
      margin:0;
      color:var(--text);
      background:linear-gradient(180deg,var(--bg-grad-1),var(--bg-grad-2)) fixed;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    header{
      position:sticky; top:0; z-index:20;
      background:linear-gradient(90deg, rgba(34,197,94,.15), rgba(34,197,94,.05));
      border-bottom:1px solid rgba(255,255,255,.06);
      text-align:center; padding:14px 10px; font-size:20px; font-weight:700;
      backdrop-filter:saturate(140%) blur(6px);
      box-shadow:0 4px 18px rgba(0,0,0,.25);
    }
    .container{max-width:980px;margin:22px auto; padding:0 16px}

    /* Tabs */
    .nav{display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin:10px auto 18px}
    .tab{background:transparent; color:var(--text); border:1px solid var(--card-border); border-radius:12px; padding:10px 14px; cursor:pointer; transition:.2s; backdrop-filter:blur(8px)}
    .tab:hover{border-color:rgba(255,255,255,.25)}
    .tab.active{background:var(--brand); color:#052e16; border-color:transparent; font-weight:700}

    /* Glass cards */
    .card{
      background:var(--card-bg);
      border:1px solid var(--card-border);
      border-radius:16px; padding:18px; box-shadow:var(--glass-shadow);
      backdrop-filter:blur(12px) saturate(140%);
      margin-bottom:22px;
    }
    .card h2{margin:8px 0 14px; font-size:18px}

    /* Modern inputs (underline style) */
    .field{display:flex; align-items:center; gap:10px; margin:12px 0}
    .icon{width:28px; height:28px; display:grid; place-items:center; border-radius:8px; background:rgba(34,197,94,.12); color:#bbf7d0}
    .control{flex:1}
    label{font-size:12px; color:var(--muted)}
    input, select{
      width:100%; background:transparent; color:var(--text); font-size:16px; border:none; outline:none;
      border-bottom:1.5px solid var(--line); padding:10px 6px 8px 2px; border-radius:0;
    }
    input:focus, select:focus{border-bottom-color:var(--brand)}

    /* Switch */
    .switch{display:inline-flex; align-items:center; gap:10px; user-select:none}
    .switch input{display:none}
    .track{width:44px; height:26px; background:#334155; border-radius:999px; position:relative; transition:.2s}
    .thumb{position:absolute; top:3px; left:3px; width:20px; height:20px; border-radius:999px; background:#cbd5e1; transition:.2s}
    .switch input:checked + .track{background:var(--brand)}
    .switch input:checked + .track .thumb{left:21px; background:#052e16}

    /* Buttons */
    .btn{background:var(--brand); color:#052e16; border:none; padding:12px 16px; border-radius:12px; font-weight:700; cursor:pointer; transition:.2s; box-shadow:0 6px 18px rgba(34,197,94,.25)}
    .btn:hover{background:var(--brand-strong)}
    .btn.ghost{background:transparent; color:var(--text); border:1px solid var(--card-border); box-shadow:none}
    .btn.loading{position:relative; pointer-events:none; opacity:.75}
    .btn.loading:after{content:""; position:absolute; inset:auto 12px auto auto; width:16px; height:16px; border:2px solid #052e16; border-top-color:transparent; border-radius:50%; animation:spin .8s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Tables */
    table{width:100%; border-collapse:collapse}
    th,td{padding:10px 12px; border-bottom:1px solid var(--line); text-align:left}
    th{color:#cbd5e1; background:rgba(255,255,255,.04)}

    /* Alerts */
    .success{background:rgba(34,197,94,.12); color:#bbf7d0; border:1px solid rgba(34,197,94,.35); padding:10px 12px; border-radius:10px; margin-top:12px; display:none}

    .hidden{display:none}
  </style>
  <script>
    // ==== YapÄ±landÄ±rma (sadece burayÄ± deÄŸiÅŸtirmen yeter) ====
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxTEziLmLTCmUpCVSB6QOvLiHPAthCcRqfDfYd-8FPCcpOq9OcB0_AE78wrwZmoZ3gc/exec';
    const SHEET_ID = '19qwcNoLZp9Pe1qiDrBo0Ptp_t23SSDpwjuVxybiNggQ';
    const ADMIN_PASS = 'admin';

    // ==== YardÄ±mcÄ±lar ====
    const $ = (s)=>document.querySelector(s);
    const byId = (id)=>document.getElementById(id);

    // TR auto-prefill for bilezik
    function setupBilezikAuto(){
      const b = byId('bilezik');
      b.addEventListener('input', ()=>{
        const v = b.value.toUpperCase().replace(/\s+/g,'');
        b.value = v.startsWith('TR') ? v : ('TR'+v.replace(/^TR/i,''));
      });
    }

    async function kaydet(){
      const btn = byId('btnKaydet');
      const adSoyad = byId('adSoyad').value.trim();
      const telefon = byId('telefon').value.trim();
      const dernek  = byId('dernek').value.trim();
      const tur     = byId('tur').value.trim();
      const tip     = byId('tip').value.trim();
      const irk     = byId('irk').value.trim();
      const cins    = byId('cins').value.trim();
      const renk    = byId('renk').value.trim();
      const yil     = byId('yil').value.trim();
      const bilezik = byId('bilezik').value.trim().toUpperCase();
      const onay    = byId('onay').checked;

      if(!adSoyad || !telefon || !dernek || !bilezik){ alert('âš ï¸ Zorunlu alanlarÄ± doldurun.'); return; }
      if(!/^TR/.test(bilezik)){ alert('Bilezik numarasÄ± TR ile baÅŸlamalÄ±.'); return; }
      if(!onay){ alert('Sergi koÅŸullarÄ± onayÄ± gerekli.'); return; }

      const payload = { adSoyad, telefon, dernek, tur, tip, irk, cins, renk, yil, bilezik };
      try{
        btn.classList.add('loading'); btn.disabled = true;
        const res = await fetch(APPS_SCRIPT_URL, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload) });
        if(!res.ok) throw new Error('HTTP '+res.status+' '+res.statusText);
        const txt = await res.text();
        if(/OK/i.test(txt)){
          byId('form').reset(); byId('successMsg').style.display='block'; setTimeout(()=>byId('successMsg').style.display='none', 2500);
        }else{ alert('Beklenmeyen yanÄ±t: '+txt); }
      }catch(err){
        alert('Kaydetme sÄ±rasÄ±nda hata oluÅŸtu: '+err.message);
      }finally{
        btn.classList.remove('loading'); btn.disabled = false;
      }
    }

    async function adminGiris(){
      const sifre = prompt('Admin ÅŸifresini giriniz:');
      if(sifre!==ADMIN_PASS){ alert('âŒ HatalÄ± ÅŸifre'); return; }
      byId('adminCard').classList.remove('hidden');
      await yukleKayitlar();
      document.getElementById('adminCard').scrollIntoView({behavior:'smooth'});
    }

    async function yukleKayitlar(){
      try{
        const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=Kayitlar`;
        const res = await fetch(url, {cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        const text = await res.text();
        const rows = text.split(/\r?\n/).filter(Boolean).map(r=>{
          // basit CSV ayrÄ±ÅŸtÄ±rÄ±cÄ± (tÄ±rnak iÃ§i virgÃ¼lleri kaba biÃ§imde iÅŸler)
          const out=[]; let cur=''; let q=false; for(const ch of r){ if(ch==='"'){ q=!q; continue; } if(ch===',' && !q){ out.push(cur); cur=''; } else { cur+=ch; } } out.push(cur); return out.map(s=>s.trim());
        });
        const tbody = $('#adminTable tbody'); tbody.innerHTML='';
        rows.slice(1).forEach((r,i)=>{
          if(!r[0]) return; // Ad Soyad boÅŸsa geÃ§
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${i+1}</td><td>${r[0]||''}</td><td>${r[1]||''}</td><td>${r[2]||''}</td><td>${r[3]||''}</td><td>${r[5]||''}</td><td>${r[6]||''}</td><td>${r[7]||''}</td><td>${r[9]||''}</td>`;
          tbody.appendChild(tr);
        });
        alert('ğŸ”„ KayÄ±tlar yenilendi.');
      }catch(err){ alert('KayÄ±tlar alÄ±namadÄ±: '+err.message); }
    }

    window.addEventListener('DOMContentLoaded', ()=>{
      setupBilezikAuto();
    });
  </script>
</head>
<body>
  <header>ğŸ” YarÄ±ÅŸma Hayvan KayÄ±t Sistemi v11</header>
  <div class="container">
    <div class="nav">
      <button class="tab active" onclick="document.getElementById('formCard').scrollIntoView({behavior:'smooth'})">ğŸ“‹ KayÄ±t Formu</button>
      <button class="tab" onclick="document.getElementById('listeCard').scrollIntoView({behavior:'smooth'})">âœ… Onay & Liste</button>
      <button class="tab" onclick="adminGiris()">ğŸ‘‘ Admin Paneli</button>
    </div>

    <!-- FORM -->
    <section id="formCard" class="card">
      <h2>Modern KayÄ±t Formu</h2>
      <form id="form" onsubmit="event.preventDefault(); kaydet();">
        <div class="field">
          <div class="icon">ğŸ‘¤</div>
          <div class="control">
            <label>Ad Soyad*</label>
            <input id="adSoyad" placeholder="Ã–rn: Ahmet YÄ±lmaz" required />
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸ“</div>
          <div class="control">
            <label>Telefon*</label>
            <input id="telefon" inputmode="numeric" pattern="[0-9]{10,15}" placeholder="5XXXXXXXXX" required />
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸ›ï¸</div>
          <div class="control">
            <label>Dernek*</label>
            <input id="dernek" placeholder="Dernek adÄ±nÄ± yazÄ±nÄ±z" required />
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸ“</div>
          <div class="control">
            <label>TÃ¼r</label>
            <select id="tur">
              <option value="Tavuk">Tavuk</option>
              <option value="Horoz">Horoz</option>
              <option value="Kaz">Kaz</option>
              <option value="Ã–rdek">Ã–rdek</option>
              <option value="TavÅŸan">TavÅŸan</option>
              <option value="GÃ¼vercin">GÃ¼vercin</option>
            </select>
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸ”¢</div>
          <div class="control">
            <label>KayÄ±t Tipi (K/T)</label>
            <select id="tip">
              <option value="K">Koleksiyon</option>
              <option value="T">Tek Hayvan</option>
            </select>
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸ§¬</div>
          <div class="control">
            <label>Irk</label>
            <input id="irk" placeholder="Irk" />
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸª¶</div>
          <div class="control">
            <label>Cins</label>
            <input id="cins" placeholder="Cins" />
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸ¨</div>
          <div class="control">
            <label>Renk</label>
            <input id="renk" placeholder="Renk" />
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸ“…</div>
          <div class="control">
            <label>YÄ±l</label>
            <input id="yil" type="number" min="2000" max="2100" placeholder="2025" />
          </div>
        </div>

        <div class="field">
          <div class="icon">ğŸ†”</div>
          <div class="control">
            <label>Bilezik No*</label>
            <input id="bilezik" placeholder="TR..." required />
          </div>
        </div>

        <div class="field" style="align-items:center">
          <div class="icon">âœ…</div>
          <label class="switch">
            <input id="onay" type="checkbox" />
            <span class="track"><span class="thumb"></span></span>
          </label>
          <div class="control"><label>Girilen bilgilerin doÄŸruluÄŸunu ve Sergi koÅŸullarÄ±nÄ± onaylÄ±yorum.</label></div>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:8px">
          <button id="btnKaydet" type="submit" class="btn">ğŸ’¾ Onayla ve Kaydet</button>
          <button type="reset" class="btn ghost">Temizle</button>
        </div>
        <div id="successMsg" class="success">âœ… KayÄ±t baÅŸarÄ±yla eklendi!</div>
      </form>
    </section>

    <!-- LÄ°STE (placeholder - istersen buraya geÃ§ici tablo baÄŸlayabiliriz) -->
    <section id="listeCard" class="card">
      <h2>Eklenen Hayvanlar (Admin panelinden gÃ¶rÃ¼ntÃ¼leyin)</h2>
      <p class="muted" style="color:var(--muted)">Not: KayÄ±tlar Google Sheet'e yazÄ±lÄ±r. GÃ¶rÃ¼ntÃ¼lemek iÃ§in aÅŸaÄŸÄ±daki Admin Panelini kullanabilirsiniz.</p>
    </section>

    <!-- ADMIN -->
    <section id="adminCard" class="card hidden">
      <h2>ğŸ‘‘ Admin Paneli</h2>
      <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px">
        <button class="btn" onclick="yukleKayitlar()">ğŸ”„ Buluttan Yenile</button>
      </div>
      <div style="overflow:auto">
        <table id="adminTable">
          <thead>
            <tr>
              <th>#</th>
              <th>Ad Soyad</th>
              <th>Telefon</th>
              <th>Dernek</th>
              <th>TÃ¼r</th>
              <th>Irk</th>
              <th>Cins</th>
              <th>Renk</th>
              <th>Bilezik</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </div>
</body>
</html>
